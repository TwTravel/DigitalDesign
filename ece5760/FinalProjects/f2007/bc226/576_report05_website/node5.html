<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Computation Pipeline</TITLE>
<META NAME="description" CONTENT="Computation Pipeline">
<META NAME="keywords" CONTENT="576_report05">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="576_report05.css">

<LINK REL="next" HREF="node6.html">
<LINK REL="previous" HREF="node4.html">
<LINK REL="up" HREF="node3.html">
<LINK REL="next" HREF="node6.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html84"
  HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="next.png"></A> 
<A NAME="tex2html82"
  HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="up.png"></A> 
<A NAME="tex2html76"
  HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html85"
  HREF="node6.html">Rastering pipeline</A>
<B> Up:</B> <A NAME="tex2html83"
  HREF="node3.html">Hardware Design</A>
<B> Previous:</B> <A NAME="tex2html77"
  HREF="node4.html">Object Pipeline</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00032000000000000000">
Computation Pipeline</A>
</H2>
<P>
<BIG CLASS="LARGE">The computation pipeline consumes edges generated by the object pipeline, and monitors <TT>edge_count</TT> for new edges to operate on.
It maintains its own counter, <TT>edge_iterator</TT>, which it uses to fetch the edge from the edge list and to save the computed edge into its own memory.
</BIG>
<P>
<BIG CLASS="LARGE">Unfortunately, there were not enough multipliers on the DE2 to have two concurrent 4x4 matrix multiplies for 18-bit wide operands<A NAME="tex2html6"
  HREF="footnode.html#foot41"><SUP><SPAN CLASS="arabic">6</SPAN></SUP></A>.
Thus, the individual types of transformations were implemented which would operate on a intermediate register file store the 4x1 vector of points.
Although this used fewer multipliers, the computation time for each edge was linear compared to the number of transformations instead of being a single 4x4 collapsed transformation matrix multiply.
</BIG>
<P>
<BIG CLASS="LARGE">The computation pipeline would fetch the operation control word for every cycle, select the proper hardware, and save the results back to the intermediate register.
Each transformation could take up to three 16-bit arguments.
Also, in order to support parametrized transformations, a scaling multiplier would operate on each of the three 16-bit arguments before reaching the transformation hardware.
The three transformations currently supported are scaling, translation, and rotation on x, y, z axises.
Their general types are represented below:
</BIG>
<P>

<UL>
<LI>Translation:

<P>
<!-- MATH
 $\left[
\begin{array}{cccc}
1 & 0 & 0 & k \cdot D_x \\
0 & 1 & 0 & k \cdot D_y \\
0 & 0 & 1 & k \cdot D_z \\
0 & 0 & 0 & 1
 \end{array} \right]
\left [ \begin{array}{c}
x \\
y \\
z \\
1 \end{array} \right ]
=
\left [ \begin{array}{c}
x + k \cdot D_x\\
y + k \cdot D_y\\
z + k \cdot D_z \\
1 \end{array} \right ]
$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="317" HEIGHT="92" BORDER="0"
 SRC="img2.png"
 ALT="\begin{displaymath}
\left[
\begin{array}{cccc}
1 &amp; 0 &amp; 0 &amp; k \cdot D_x \\
0 &amp; 1...
...
y + k \cdot D_y\\
z + k \cdot D_z \\
1 \end{array} \right ]
\end{displaymath}"></SPAN>


<P>
</LI>
<LI>Scaling: 

<P>
<!-- MATH
 $\left[
\begin{array}{cccc}
k \cdot S_x & 0 & 0 & 0 \\
0 & k \cdot S_y & 0 & 0 \\
0 & 0 & k \cdot S_z & 0 \\
0 & 0 & 0 & 1
 \end{array} \right]
\left [ \begin{array}{c}
x \\
y \\
z \\
1 \end{array} \right ]
=
\left [ \begin{array}{c}
x k S_x \\
y k S_y \\
z k S_z \\
1 \end{array} \right ]
$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="338" HEIGHT="92" BORDER="0"
 SRC="img3.png"
 ALT="\begin{displaymath}
\left[
\begin{array}{cccc}
k \cdot S_x &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; k...
...{c}
x k S_x \\
y k S_y \\
z k S_z \\
1 \end{array} \right ]
\end{displaymath}"></SPAN>


<P>
</LI>
<LI>Rotation about the x-axis:

<P>
<!-- MATH
 $\left[
\begin{array}{cccc}
1 & 0 & 0 & 0 \\
0 & \cos(k \theta) & -\sin(k \theta) & 0 \\
0 & \sin(k \theta) & \cos(k \theta) & 0 \\
0 & 0 & 0 & 1
 \end{array} \right]
\left [ \begin{array}{c}
x \\
y \\
z \\
1 \end{array} \right ]
=
\left [ \begin{array}{c}
x \\
y \cos(k \theta) - z \sin(k \theta) \\
y \sin(k \theta) + z \cos(k \theta) \\
1 \end{array} \right ]
$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="452" HEIGHT="92" BORDER="0"
 SRC="img4.png"
 ALT="\begin{displaymath}
\left[
\begin{array}{cccc}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \cos(k \the...
...y \sin(k \theta) + z \cos(k \theta) \\
1 \end{array} \right ]
\end{displaymath}"></SPAN>


<P>
</LI>
<LI>Rotation about the y-axis:

<P>
<!-- MATH
 $\left[
\begin{array}{cccc}
\cos(k \theta) & 0 & \sin(k \theta) & 0\\
0 & 1 & 0 & 0 \\
-\sin(k \theta) & 0 & \cos(k \theta) & 0 \\
0 & 0 & 0 & 1
 \end{array} \right]
\left [ \begin{array}{c}
x \\
y \\
z \\
1 \end{array} \right ]
=
\left [ \begin{array}{c}
x \cos(k \theta) + z \sin(k \theta) \\
y \\
-x \sin(k \theta) + z \cos(k \theta) \\
1 \end{array} \right ]
$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="465" HEIGHT="92" BORDER="0"
 SRC="img5.png"
 ALT="\begin{displaymath}
\left[
\begin{array}{cccc}
\cos(k \theta) &amp; 0 &amp; \sin(k \thet...
...x \sin(k \theta) + z \cos(k \theta) \\
1 \end{array} \right ]
\end{displaymath}"></SPAN>


<P>
</LI>
<LI>Rotation about the z-axis:

<P>
<!-- MATH
 $\left[
\begin{array}{cccc}
\cos(k \theta) & -\sin(k \theta) & 0 & 0 \\
\sin(k \theta) & \cos(k \theta) & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
 \end{array} \right]
\left [ \begin{array}{c}
x \\
y \\
z \\
1 \end{array} \right ]
=
\left [ \begin{array}{c}
x \cos(k \theta) - y \sin(k \theta) \\
x \sin(k \theta) + y \cos(k \theta) \\
z \\
1 \end{array} \right ]
$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="453" HEIGHT="92" BORDER="0"
 SRC="img6.png"
 ALT="\begin{displaymath}
\left[
\begin{array}{cccc}
\cos(k \theta) &amp; -\sin(k \theta) ...
...(k \theta) + y \cos(k \theta) \\
z \\
1 \end{array} \right ]
\end{displaymath}"></SPAN>

</LI>
</UL>
<P>
<BIG CLASS="LARGE">In all, the five transformation modules use 10.5<A NAME="tex2html7"
  HREF="footnode.html#foot89"><SUP><SPAN CLASS="arabic">7</SPAN></SUP></A> 18-bit multipliers for two points (one edge), compared with the 17.5 18-bit multipliers if 4x4 matrix multiplies were employed.
Since we transform an edge at a time, we use 21 of the 35 18-bit multipliers on the FPGA.
</BIG>
<P>
<BIG CLASS="LARGE">The computation pipeline also addresses operations that could take more than one cycle, and if the transformation module does not assert the <TT>done</TT> signal in one cycle, the pipeline will stall before proceeding to load the next operation.
</BIG>
<P>
<BIG CLASS="LARGE">Once it completes all the operations for each data set (the two points), the pipeline saves the results from the temporary registers into the second memory bank, and increments <TT>comp_count</TT>.
</BIG>
<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html84"
  HREF="node6.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="next.png"></A> 
<A NAME="tex2html82"
  HREF="node3.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="up.png"></A> 
<A NAME="tex2html76"
  HREF="node4.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html85"
  HREF="node6.html">Rastering pipeline</A>
<B> Up:</B> <A NAME="tex2html83"
  HREF="node3.html">Hardware Design</A>
<B> Previous:</B> <A NAME="tex2html77"
  HREF="node4.html">Object Pipeline</A></DIV>
<!--End of Navigation Panel-->
<ADDRESS>

2007-12-02
</ADDRESS>
</BODY>
</HTML>
